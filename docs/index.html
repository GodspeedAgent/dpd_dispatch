<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>DPD Dispatch Dashboard</title>
    <link rel="stylesheet" href="./css/styles.css" />
  </head>
  <body>
    <header class="top">
      <div class="brand">ðŸ“Ÿ DPD Dispatch</div>
      <div style="display:flex; gap:10px; align-items:center;">
        <a class="badge" href="./index.html">Dashboard</a>
        <a class="badge" href="./references.html">References</a>
        <a class="badge" href="./visuals.html">Visuals</a>
        <a class="badge" href="./beat.html">Beat Profile</a>
        <div class="status" id="status">Loadingâ€¦</div>
      </div>
    </header>

    <main class="container">
      <section class="card">
        <h1>Active Calls Snapshot</h1>
        <p class="muted">This UI reads JSON generated by the Python pipeline and committed to <code>/docs/data</code>.</p>
        <div class="grid">
          <div class="metric">
            <div class="label">Total calls</div>
            <div class="value" id="totalCalls">â€”</div>
          </div>
          <div class="metric">
            <div class="label">Updated</div>
            <div class="value" id="updatedAt">â€”</div>
          </div>
        </div>
      </section>

      <details class="card" open>
        <summary><h2>By Beat</h2></summary>
        <div id="byRegionBeat" class="table"></div>
      </details>

      <section class="card">
        <h2>Active Calls â€” Filters</h2>
        <div class="controls">
          <div class="control">
            <label for="activeBeat">Beat</label>
            <input id="activeBeat" placeholder="e.g. 215" />
          </div>
          <div class="control">
            <label for="activeNature">Nature contains</label>
            <input id="activeNature" placeholder="e.g. burglary" />
          </div>
          <div class="control">
            <label for="activeLimit">Rows</label>
            <select id="activeLimit">
              <option value="50">50</option>
              <option value="100">100</option>
              <option value="200" selected>200</option>
              <option value="500">500</option>
            </select>
          </div>
          <button class="button" id="activeClear">Clear</button>
        </div>
        <p class="muted" id="activeFilterSummary">â€”</p>
      </section>

      <details class="card" open>
        <summary><h2>Raw Calls</h2></summary>
        <div id="rawCalls" class="table"></div>
      </details>

      <section class="card">
        <h2 id="histTitle">Historical Snapshot</h2>
        <p class="muted">Generated by Python into <code>/docs/data/historical_snapshot.json</code> (on-demand, committed to main).</p>
        <div class="grid">
          <div class="metric">
            <div class="label">Total incidents</div>
            <div class="value" id="histTotal">â€”</div>
          </div>
          <div class="metric">
            <div class="label">Generated</div>
            <div class="value" id="histGenerated">â€”</div>
          </div>
        </div>
      </section>

      <section class="card">
        <h2>Historical â€” Filters (client-side)</h2>
        <div class="controls">
          <div class="control">
            <label for="histBeat">Beat</label>
            <input id="histBeat" placeholder="e.g. 215" />
          </div>
          <div class="control">
            <label for="histDivision">Division</label>
            <input id="histDivision" placeholder="e.g. NORTHEAST" />
          </div>
          <div class="control">
            <label for="histText">Offense/address contains</label>
            <input id="histText" placeholder="e.g. forced entry" />
          </div>
          <div class="control">
            <label for="histLimit">Rows</label>
            <select id="histLimit">
              <option value="50">50</option>
              <option value="100">100</option>
              <option value="200" selected>200</option>
            </select>
          </div>
          <button class="button" id="histClear">Clear</button>
        </div>
        <p class="muted" id="histFilterSummary">â€”</p>
      </section>

      <details class="card">
        <summary><h2>Historical â€” Top Beats</h2></summary>
        <div id="histTopBeats" class="table"></div>
      </details>

      <details class="card">
        <summary><h2>Historical â€” Top Offenses</h2></summary>
        <div id="histTopOffenses" class="table"></div>
      </details>

      <details class="card">
        <summary><h2>Historical â€” Incidents (first 200)</h2></summary>
        <div id="histRows" class="table"></div>
      </details>
    </main>

    <script src="./js/app.js"></script>
  </body>
</html>
